<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started • pipetree</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pipetree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/pipetree.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Getting Started</h1>
                        <h4 class="author">Matthew Mark Strasiotto</h4>
            
      
      
      <div class="hidden name"><code>pipetree.Rmd</code></div>

    </div>

    
    
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#library(pipetree)</span></code></pre></div>
<div id="intoduction-to-pipetree" class="section level1">
<h1 class="hasAnchor">
<a href="#intoduction-to-pipetree" class="anchor"></a>Intoduction to Pipetree</h1>
<p>The goal of pipetree is to make navigating the project structure of the speed-extract project as simple as possible, and to automate the most commonly used tasks in accessing and exploring the dataset.</p>
<p>The most important functionalities provided are as follows:</p>
<ol style="list-style-type: decimal">
<li>Consistent access of a given dataset’s root directory accross remote volumes, whose mount points may change ( [portrpaths::PortrPath]. )</li>
<li>Consistent Access to the filetree structure, that is used by the any SPEED-EXTRACT pipeline workflow/dataset.</li>
<li>Straightforward access to the [drake::drake_cache()] for a particular dataset. IE- Immediate access to the results, outputs, and targets generated by the data pipeline, as soon as these results are available.</li>
<li>
<strong>PLANNED</strong> access to structured metadata for a given dataset, so:</li>
</ol>
<ul>
<li>users have useful information about the distinguishing characteristics of that dataset, and</li>
<li>projects have useful aliases for structured and versioned logging of target statistics.
<ul>
<li>Use cases for this include:
<ol style="list-style-type: decimal">
<li>Allowing versioned tracking of multiple datasets’<br>
[drake::drake_cache_log], within a versioned project/repo within separate subdirectories of the project that builds these targets.</li>
<li>Allowing more in-depth data versioning, such as versioned <code>yaml</code> files describing high level aggregates of a given dataframe across the workflow, eg <code>yaml    n_journeys: 100    n_journeys_stemi: 5</code>
</li>
</ol>
</li>
</ul>
</li>
</ul>
</div>
<div id="portable-access-to-datasets" class="section level1">
<h1 class="hasAnchor">
<a href="#portable-access-to-datasets" class="anchor"></a>Portable Access to Datasets</h1>
<p>Portable access to datasets is driven by the [portrpaths::PortrPath] class, using the [get_portrpaths()] function.</p>
<p>This expects a local <code>yaml</code> config file at a location specified by the user. This may be specified in one of a few ways:</p>
<div id="using-the-pipetree-config-option" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-pipetree-config-option" class="anchor"></a>Using the pipetree.config option</h2>
<p>By setting the global option <code>pipetree.config = /path/to/your/config.yaml</code>, possibly in your user level <em>.Rprofile</em> (<em>~/.Rprofile</em>), or your project-level <em>Rprofile</em> (<code><a href="https://rdrr.io/pkg/here/man/here.html">here::here()</a></code> <em>/.Rprofile</em> ), a consistent location for this configuration file may be specified. This option may be useful for interactive users, but it is not recommended that package developers include this in any of their code, though it may be appropiate for a project level <em>.Rprofile</em>.</p>
<div id="examining-the-config" class="section level3">
<h3 class="hasAnchor">
<a href="#examining-the-config" class="anchor"></a>Examining the config</h3>
<p>Lets examine the file we’re going to tell our options to use</p>
<p>The path:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(option_config, <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)
<span class="co">#&gt; /var/folders/sn/jqrwf4ls0cj7f9jml4b3yjt00000gn/T//RtmpEgL1ht/option_config.yaml</span></code></pre></div>
<p>The contents:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (ln <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span>(option_config)) <span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(ln, <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)
<span class="co">#&gt; d_root: /project/STEMI/</span></code></pre></div>
</div>
<div id="setting-the-option" class="section level3">
<h3 class="hasAnchor">
<a href="#setting-the-option" class="anchor"></a>Setting the option</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">pipetree.config =</span> option_config)</code></pre></div>
<p>Now let’s load this configuration:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">portrpath &lt;-<span class="st"> </span>pipetree<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/pipetree/man/get_portrpath.html">get_portrpath</a></span>()
<span class="co">#&gt; Warning in resolve_config_path(): No config path supplied, using</span>
<span class="co">#&gt; getOption('pipetree.config')</span>
<span class="co">#&gt; 2020-01-29 15:55:03 </span><span class="al">WARNING</span><span class="co">:pipetree:No config path supplied, using getOption('pipetree.config')</span>
<span class="co">#&gt; 2020-01-29 15:55:03 INFO:PortrPath:Root in: /project/STEMI/</span>
portrpath
<span class="co">#&gt; Root: /project/STEMI/</span>
<span class="co">#&gt; Profiles:</span></code></pre></div>
</div>
</div>
<div id="allowing-the-default-path-to-be-used" class="section level2">
<h2 class="hasAnchor">
<a href="#allowing-the-default-path-to-be-used" class="anchor"></a>Allowing the default path to be used</h2>
<p>The default path for the configuration is relative to the active Rproject, and given by pipetree::default_config_path().</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">default_config &lt;-<span class="st"> </span>pipetree<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/pipetree/man/default_config_path.html">default_config_path</a></span>()
<span class="co">#&gt; 2020-01-29 15:55:03 </span><span class="al">WARNING</span><span class="co">:pipetree:No path given, using default: /Users/matthew/Documents/GitHub/pipetree/local.yaml</span>
<span class="co">#&gt; Warning in pipetree::default_config_path(): No path given, using default: /</span>
<span class="co">#&gt; Users/matthew/Documents/GitHub/pipetree/local.yaml</span>
<span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(default_config, <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)
<span class="co">#&gt; /Users/matthew/Documents/GitHub/pipetree/local.yaml</span></code></pre></div>
<p>Examining its contents:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (ln <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span>(default_config)) <span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(ln, <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)
<span class="co">#&gt; d_root: /default/path/to/dataset</span>
<span class="co">#&gt; info: |</span>
<span class="co">#&gt;   This config is specified in ./vignettes/default_config.yaml, and copied to</span>
<span class="co">#&gt;   ./local.yaml whenever the Getting Started vignette is run.</span>
<span class="co">#&gt;   It is intended only as a demonstration</span>
<span class="co">#&gt; profiles:</span>
<span class="co">#&gt;   default: /default/path/to/dataset</span>
<span class="co">#&gt;   alt: /alternate/path/to/dataset</span></code></pre></div>
<p>Calling get_portrpath() with <code>pipetree.config</code> unset will behave differently:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">pipetree.config =</span> <span class="ot">NULL</span>)
portrpath &lt;-<span class="st"> </span>pipetree<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/pipetree/man/get_portrpath.html">get_portrpath</a></span>()
<span class="co">#&gt; Warning in resolve_config_path(): No config path supplied, using</span>
<span class="co">#&gt; getOption('pipetree.config')</span>
<span class="co">#&gt; 2020-01-29 15:55:03 </span><span class="al">WARNING</span><span class="co">:pipetree:No config path supplied, using getOption('pipetree.config')</span>
<span class="co">#&gt; 2020-01-29 15:55:03 </span><span class="al">WARNING</span><span class="co">:pipetree:No path given, using default: /Users/matthew/Documents/GitHub/pipetree/local.yaml</span>
<span class="co">#&gt; Warning in default_config_path(): No path given, using default: /Users/matthew/</span>
<span class="co">#&gt; Documents/GitHub/pipetree/local.yaml</span>
<span class="co">#&gt; 2020-01-29 15:55:03 INFO:PortrPath:Root in: /default/path/to/dataset</span>
portrpath
<span class="co">#&gt; Root: /default/path/to/dataset</span>
<span class="co">#&gt; Profiles:</span>
<span class="co">#&gt;     default: /default/path/to/dataset</span>
<span class="co">#&gt;     alt: /alternate/path/to/dataset</span></code></pre></div>
</div>
<div id="setting-the-path-explicitly" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-the-path-explicitly" class="anchor"></a>Setting the path explicitly</h2>
<p>The path may be set explicitly using the <code>config_path</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">portrpath &lt;-<span class="st"> </span>pipetree<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/pipetree/man/get_portrpath.html">get_portrpath</a></span>(<span class="dt">config_path =</span> option_config)
<span class="co">#&gt; 2020-01-29 15:55:03 INFO:PortrPath:Root in: /project/STEMI/</span>
portrpath
<span class="co">#&gt; Root: /project/STEMI/</span>
<span class="co">#&gt; Profiles:</span>
<span class="co">#&gt;     default: /project/STEMI/</span></code></pre></div>
<p>Let’s return to the convenience of using the <code><a href="https://rdrr.io/r/base/options.html">options(pipetree.config)</a></code>, for now.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">pipetree.config =</span> option_config)
portrpath &lt;-<span class="st"> </span>pipetree<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/pipetree/man/get_portrpath.html">get_portrpath</a></span>()
<span class="co">#&gt; Warning in resolve_config_path(): No config path supplied, using</span>
<span class="co">#&gt; getOption('pipetree.config')</span>
<span class="co">#&gt; 2020-01-29 15:55:03 </span><span class="al">WARNING</span><span class="co">:pipetree:No config path supplied, using getOption('pipetree.config')</span>
<span class="co">#&gt; 2020-01-29 15:55:03 INFO:PortrPath:Root in: /project/STEMI/</span></code></pre></div>
</div>
<div id="using-the-config" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-config" class="anchor"></a>Using the config</h2>
<p>For demonstration purposes, let’s set our project directory to a temporary directory.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">portrpath<span class="op">$</span><span class="kw">add_profile</span>(<span class="st">"temp"</span>, temp_root)
portrpath<span class="op">$</span>profile &lt;-<span class="st"> "temp"</span>
<span class="co">#&gt; Setting profile to temp</span>
<span class="co">#&gt; 2020-01-29 15:55:03 INFO:PortrPath:Root in: /var/folders/sn/jqrwf4ls0cj7f9jml4b3yjt00000gn/T//RtmpEgL1ht</span>
<span class="co">#&gt; Setting root to /var/folders/sn/jqrwf4ls0cj7f9jml4b3yjt00000gn/T//RtmpEgL1ht</span>
portrpath
<span class="co">#&gt; Root: /var/folders/sn/jqrwf4ls0cj7f9jml4b3yjt00000gn/T//RtmpEgL1ht</span>
<span class="co">#&gt; Profiles:</span>
<span class="co">#&gt;     default: /project/STEMI/</span>
<span class="co">#&gt;     temp: /var/folders/sn/jqrwf4ls0cj7f9jml4b3yjt00000gn/T//RtmpEgL1ht</span></code></pre></div>
</div>
</div>
<div id="access-to-the-filetree" class="section level1">
<h1 class="hasAnchor">
<a href="#access-to-the-filetree" class="anchor"></a>Access to the filetree</h1>
<p>To access the filetree, we use get_paths(), similarly to how we loaded our config.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">paths &lt;-<span class="st"> </span>pipetree<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/pipetree/man/get_paths.html">get_paths</a></span>()
<span class="co">#&gt; Warning in resolve_config_path(): No config path supplied, using</span>
<span class="co">#&gt; getOption('pipetree.config')</span>
<span class="co">#&gt; 2020-01-29 15:55:03 </span><span class="al">WARNING</span><span class="co">:pipetree:No config path supplied, using getOption('pipetree.config')</span>
<span class="co">#&gt; 2020-01-29 15:55:03 INFO:PortrPath:Root in: /var/folders/sn/jqrwf4ls0cj7f9jml4b3yjt00000gn/T//RtmpEgL1ht</span>
paths
<span class="co">#&gt; $pipeline</span>
<span class="co">#&gt; [1] "/var/folders/sn/jqrwf4ls0cj7f9jml4b3yjt00000gn/T//RtmpEgL1ht/pipeline"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $raw</span>
<span class="co">#&gt; [1] "/var/folders/sn/jqrwf4ls0cj7f9jml4b3yjt00000gn/T//RtmpEgL1ht/pipeline/raw"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $preprocessed</span>
<span class="co">#&gt; [1] "/var/folders/sn/jqrwf4ls0cj7f9jml4b3yjt00000gn/T//RtmpEgL1ht/pipeline/preprocessed"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $unclean</span>
<span class="co">#&gt; [1] "/var/folders/sn/jqrwf4ls0cj7f9jml4b3yjt00000gn/T//RtmpEgL1ht/pipeline/preprocessed/unclean"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $partition</span>
<span class="co">#&gt; [1] "/var/folders/sn/jqrwf4ls0cj7f9jml4b3yjt00000gn/T//RtmpEgL1ht/pipeline/partition"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $root</span>
<span class="co">#&gt; [1] "/var/folders/sn/jqrwf4ls0cj7f9jml4b3yjt00000gn/T//RtmpEgL1ht"</span></code></pre></div>
</div>
<div id="accessing-the-cache" class="section level1">
<h1 class="hasAnchor">
<a href="#accessing-the-cache" class="anchor"></a>Accessing the cache</h1>
<p>For this demonstration, there is no real cache in place, but we can pretend.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cache &lt;-<span class="st"> </span>pipetree<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/pipetree/man/get_cache.html">get_cache</a></span>()
<span class="co">#&gt; Warning in resolve_config_path(): No config path supplied, using</span>
<span class="co">#&gt; getOption('pipetree.config')</span>
<span class="co">#&gt; 2020-01-29 15:55:03 </span><span class="al">WARNING</span><span class="co">:pipetree:No config path supplied, using getOption('pipetree.config')</span>
<span class="co">#&gt; 2020-01-29 15:55:03 INFO:PortrPath:Root in: /var/folders/sn/jqrwf4ls0cj7f9jml4b3yjt00000gn/T//RtmpEgL1ht</span>
<span class="co">#&gt; 2020-01-29 15:55:03 INFO:pipetree:Configuring drake to use an SQL based cache @ /var/folders/sn/jqrwf4ls0cj7f9jml4b3yjt00000gn/T//RtmpEgL1ht/pipeline/drake_cache.sqlite</span></code></pre></div>
<p>To use this cache to extract a target, for example, we have a target in our drake::drake_plan() called <code>mtcars</code>, we do the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtc &lt;-<span class="st"> </span>drake<span class="op">::</span><span class="kw">readd</span>(mtcars, <span class="dt">cache =</span> cache)</code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#intoduction-to-pipetree">Intoduction to Pipetree</a></li>
      <li>
<a href="#portable-access-to-datasets">Portable Access to Datasets</a><ul class="nav nav-pills nav-stacked">
<li><a href="#using-the-pipetree-config-option">Using the pipetree.config option</a></li>
      <li><a href="#allowing-the-default-path-to-be-used">Allowing the default path to be used</a></li>
      <li><a href="#setting-the-path-explicitly">Setting the path explicitly</a></li>
      <li><a href="#using-the-config">Using the config</a></li>
      </ul>
</li>
      <li><a href="#access-to-the-filetree">Access to the filetree</a></li>
      <li><a href="#accessing-the-cache">Accessing the cache</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matthew Mark Strasiotto.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
